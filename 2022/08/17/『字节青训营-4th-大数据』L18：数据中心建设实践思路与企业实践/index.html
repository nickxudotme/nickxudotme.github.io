<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>『字节青训营-4th-大数据』L18：数据中心建设实践思路与企业实践 | NX の 博客</title><meta name="author" content="Nick Xu"><meta name="copyright" content="Nick Xu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="相关链接🎶 学员手册：【大数据专场 学习资料六】第四届字节跳动青训营 - 掘金    企业数据架构  数据集成 业务数据收集 CDC  Log  系统间同步传输  数据生产 - 离线&amp;amp;实时  数据服务  数据中心案例  核心业务指标  数据查询要求  实时数据生产 数据分析 数据产出..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "『字节青训营-4th-大数据』L18：数据中心建设实践思路与企业实践",
  "url": "https://nickxu.me/2022/08/17/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL18%EF%BC%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E5%BB%BA%E8%AE%BE%E5%AE%9E%E8%B7%B5%E6%80%9D%E8%B7%AF%E4%B8%8E%E4%BC%81%E4%B8%9A%E5%AE%9E%E8%B7%B5/",
  "image": "https://nickxu.me/static/202202230023069.jpg",
  "datePublished": "2022-08-17T13:46:58.000Z",
  "dateModified": "2023-08-15T05:42:18.229Z",
  "author": [
    {
      "@type": "Person",
      "name": "Nick Xu",
      "url": "https://nickxu.me"
    }
  ]
}</script><link rel="shortcut icon" href="/static/icon.png"><link rel="canonical" href="https://nickxu.me/2022/08/17/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL18%EF%BC%9A%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E5%BB%BA%E8%AE%BE%E5%AE%9E%E8%B7%B5%E6%80%9D%E8%B7%AF%E4%B8%8E%E4%BC%81%E4%B8%9A%E5%AE%9E%E8%B7%B5/index.html"><link rel="preconnect"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=7.1.0"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3573ab9aac9d53e5c34fea51e076a07d";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-VBKFEG3YFD"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-VBKFEG3YFD')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-VBKFEG3YFD', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.12.0',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '『字节青训营-4th-大数据』L18：数据中心建设实践思路与企业实践',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/static/my.css"><script async src="https://analytics.umami.is/script.js" data-website-id="cabaee36-5ea6-431c-8f56-4127be850896"></script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="NX の 博客" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="NX の 博客" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/static/favicon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">301</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-coffee"></i><span> 更多</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/contact/"><i class="fa-fw fas fa-comments"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/bookmarks/"><i class="fa-fw fas fa-bookmark"></i><span> 网址收藏</span></a></li><li><a class="site-page child" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/static/202202230023069.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">NX の 博客</span></a><a class="nav-page-title" href="/"><span class="site-name">『字节青训营-4th-大数据』L18：数据中心建设实践思路与企业实践</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-coffee"></i><span> 更多</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/contact/"><i class="fa-fw fas fa-comments"></i><span> 留言板</span></a></li><li><a class="site-page child" href="/bookmarks/"><i class="fa-fw fas fa-bookmark"></i><span> 网址收藏</span></a></li><li><a class="site-page child" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">『字节青训营-4th-大数据』L18：数据中心建设实践思路与企业实践</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-17T13:46:58.000Z" title="发表于 2022-08-17 21:46:58">2022-08-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-15T05:42:18.229Z" title="更新于 2023-08-15 13:42:18">2023-08-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/">青训营</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9D%92%E8%AE%AD%E8%90%A5/%E5%AD%97%E8%8A%82%E8%B7%B3%E5%8A%A8-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE/">字节跳动-4th-大数据</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">331</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>1分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:300,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2023-08-15 13:42:18&quot;}" hidden></div><details class="toggle" ><summary class="toggle-button" style="">相关链接</summary><div class="toggle-content"><p>🎶 学员手册：<a target="_blank" rel="noopener" href="https://juejin.cn/post/7130131931722678308#heading-104">【大数据专场 学习资料六】第四届字节跳动青训营 - 掘金</a></p>
</div></details>
<p><img src="https://image.nickxu.me/202208251053030.png" alt="image-20220825105328879"></p>
<p><img src="https://image.nickxu.me/202208251054089.png" alt="image-20220825105438973"></p>
<h1 id="企业数据架构">企业数据架构</h1>
<p><img src="https://image.nickxu.me/202208251057176.png" alt="image-20220825105745083"></p>
<h2 id="数据集成">数据集成</h2>
<h3 id="业务数据收集">业务数据收集</h3>
<h4 id="CDC">CDC</h4>
<p><img src="https://image.nickxu.me/202208251101585.png" alt="image-20220825110112486"></p>
<h4 id="Log">Log</h4>
<p><img src="https://image.nickxu.me/202208251102241.png" alt="image-20220825110222108"></p>
<h3 id="系统间同步传输">系统间同步传输</h3>
<p><img src="https://image.nickxu.me/202208251102185.png" alt="image-20220825110259036"></p>
<h2 id="数据生产-离线-实时">数据生产 - 离线&amp;实时</h2>
<p><img src="https://image.nickxu.me/202208251103146.png" alt="image-20220825110355993"></p>
<h2 id="数据服务">数据服务</h2>
<p><img src="https://image.nickxu.me/202208251106667.png" alt="image-20220825110620562"></p>
<h1 id="数据中心案例">数据中心案例</h1>
<p><img src="https://image.nickxu.me/202208251112771.png" alt="image-20220825111236684"></p>
<h2 id="核心业务指标">核心业务指标</h2>
<p><img src="https://image.nickxu.me/202208251115619.png" alt="image-20220825111502508"></p>
<h2 id="数据查询要求">数据查询要求</h2>
<p><img src="https://image.nickxu.me/202208251116572.png" alt="image-20220825111653464"></p>
<h1 id="实时数据生产">实时数据生产</h1>
<h2 id="数据分析">数据分析</h2>
<h3 id="数据产出目标">数据产出目标</h3>
<p><img src="https://image.nickxu.me/202208251119082.png" alt="image-20220825111913955"></p>
<h3 id="数据生产可行性">数据生产可行性</h3>
<p><img src="https://image.nickxu.me/202208251121636.png" alt="image-20220825112113506"></p>
<h2 id="计算分析">计算分析</h2>
<h3 id="目标">目标</h3>
<p><img src="https://image.nickxu.me/202208251128164.png" alt="image-20220825112857030"></p>
<h3 id="计算架构-Lambda">计算架构 - Lambda</h3>
<p><img src="https://image.nickxu.me/202208251129612.png" alt="image-20220825112957521"></p>
<h4 id="数据产出">数据产出</h4>
<p><img src="https://image.nickxu.me/202208251131196.png" alt="image-20220825113113072"></p>
<p>查询的时候把离线和实时合并后返回</p>
<h4 id="问题">问题</h4>
<p><img src="https://image.nickxu.me/202208251132258.png" alt="image-20220825113242127"></p>
<p>过去的离线数据在今天发生变更，这是一个问题</p>
<h3 id="计算架构-全量计算">计算架构 - 全量计算</h3>
<p><img src="https://image.nickxu.me/202208251136211.png" alt="image-20220825113614058"></p>
<h4 id="问题解决">问题解决</h4>
<p><img src="https://image.nickxu.me/202208251136745.png" alt="image-20220825113641594"></p>
<h4 id="全量计算问题">全量计算问题</h4>
<p><img src="https://image.nickxu.me/202208251137418.png" alt="image-20220825113740290"></p>
<h3 id="计算架构-架构选择">计算架构 - 架构选择</h3>
<p><img src="https://image.nickxu.me/202208251138217.png" alt="image-20220825113833109"></p>
<h2 id="计算难点">计算难点</h2>
<h3 id="全量数据获取-Hybrid-Source">全量数据获取 - Hybrid Source</h3>
<p><img src="https://image.nickxu.me/202208251140047.png" alt="image-20220825114007933"></p>
<h3 id="准确-处理去重-更新">准确 - 处理去重&amp;更新</h3>
<p><img src="https://image.nickxu.me/202208251140785.png" alt="image-20220825114051671"></p>
<h3 id="准确-Join-乱序问题场景">准确 - Join 乱序问题场景</h3>
<p><img src="https://image.nickxu.me/202208261231587.png" alt="image-20220826123127347"></p>
<p><img src="https://image.nickxu.me/202208261234226.png" alt="image-20220826123418976"></p>
<p><img src="https://image.nickxu.me/202208261235663.png" alt="image-20220826123523447"></p>
<p><img src="https://image.nickxu.me/202208261237097.png" alt="image-20220826123707883"></p>
<h3 id="效率-聚合">效率 - 聚合</h3>
<p><img src="https://image.nickxu.me/202208261238541.png" alt="image-20220826123800278"></p>
<h3 id="效率-Join">效率 - Join</h3>
<p><img src="https://image.nickxu.me/202208261324589.png" alt="image-20220826132401467"></p>
<p><img src="https://image.nickxu.me/202208261326735.png" alt="image-20220826132659614"></p>
<h3 id="数据质量">数据质量</h3>
<h4 id="任务稳定性">任务稳定性</h4>
<p><img src="https://image.nickxu.me/202208261328682.png" alt="image-20220826132841537"></p>
<h4 id="数据持续正确性">数据持续正确性</h4>
<p><img src="https://image.nickxu.me/202208261330281.png" alt="image-20220826133027152"></p>
<h3 id="计算总结">计算总结</h3>
<p><img src="https://image.nickxu.me/202208261331051.png" alt="image-20220826133154898"></p>
<h2 id="数仓建设">数仓建设</h2>
<p><img src="https://image.nickxu.me/202208261337414.png" alt="image-20220826133717288"></p>
<h3 id="数据组织方案">数据组织方案</h3>
<p><img src="https://image.nickxu.me/202208261339211.png" alt="image-20220826133927104"></p>
<h3 id="元数据管理">元数据管理</h3>
<p><img src="https://image.nickxu.me/202208261340062.png" alt="image-20220826134012961"></p>
<h1 id="数据服务-2">数据服务</h1>
<p><img src="https://image.nickxu.me/202208261343449.png" alt="image-20220826134312353"></p>
<h2 id="查询快">查询快</h2>
<h3 id="引擎选择">引擎选择</h3>
<p><img src="https://image.nickxu.me/202208261345904.png" alt="image-20220826134536763"></p>
<h3 id="怎么做">怎么做</h3>
<p><img src="https://image.nickxu.me/202208261346440.png" alt="image-20220826134626338"></p>
<p><img src="https://image.nickxu.me/202208261348462.png" alt="image-20220826134850348"></p>
<p>列存的重要性</p>
<h3 id="筛选">筛选</h3>
<h4 id="分区">分区</h4>
<p><img src="https://image.nickxu.me/202208261350551.png" alt="image-20220826135023441"></p>
<h4 id="主键构建">主键构建</h4>
<p><img src="https://image.nickxu.me/202208261631306.png" alt="image-20220826163107183"></p>
<h4 id="主键查找">主键查找</h4>
<p><img src="https://image.nickxu.me/202208261632392.png" alt="image-20220826163228296"></p>
<h3 id="原始信息关联">原始信息关联</h3>
<p><img src="https://image.nickxu.me/202208261633704.png" alt="image-20220826163355587"></p>
<h3 id="计算向量化">计算向量化</h3>
<p><img src="https://image.nickxu.me/202208261636044.png" alt="image-20220826163622909"></p>
<h3 id="执行计划">执行计划</h3>
<p><img src="https://image.nickxu.me/202208261637213.png" alt="image-20220826163712114"></p>
<h3 id="应用优化">应用优化</h3>
<p><img src="https://image.nickxu.me/202208261639011.png" alt="image-20220826163944892"></p>
<h3 id="宽表构建">宽表构建</h3>
<p><img src="https://image.nickxu.me/202208261640533.png" alt="image-20220826164055433"></p>
<h3 id="提升信息密度">提升信息密度</h3>
<p><img src="https://image.nickxu.me/202208291030353.png" alt="image-20220829103041158"></p>
<p><img src="https://image.nickxu.me/202208291031822.png" alt="image-20220829103141613"></p>
<h2 id="稳定">稳定</h2>
<p><img src="https://image.nickxu.me/202208291032630.png" alt="image-20220829103258475"></p>
<p><img src="https://image.nickxu.me/202208291033417.png" alt="image-20220829103340154"></p>
<h2 id="数据管理">数据管理</h2>
<p><img src="https://image.nickxu.me/202208291034946.png" alt="image-20220829103421708"></p>
<h1 id="课程总结">课程总结</h1>
<p><img src="https://image.nickxu.me/202208291034120.png" alt="image-20220829103432861"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/">字节青训营</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2022/08/16/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL17%EF%BC%9A%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3-K8S-%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%92%8C%E8%B0%83%E5%BA%A6/" title="『字节青训营-4th-大数据』L17：深入理解 K8S 资源管理和调度"><img class="cover" src="/static/202202230023069.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">『字节青训营-4th-大数据』L17：深入理解 K8S 资源管理和调度</div></div><div class="info-2"><div class="info-item-1">相关链接🎶 学员手册：【大数据专场 学习资料六】第四届字节跳动青训营 - 掘金      Kubernetes 简介 为什么要 k8s  k8s 是什么  k8s 核心概念   Pod   spec：pod的核心配置，可以配置多个 containers  Volume/PV/PVC/StrorageClass  Volume 太老了直接跳过 Deployment  template 就是一个 pod 的声明 StatefulSet  Node  k8s 设计准则   声明式而不是命令式：告诉 k8s 最终想要什么状态，而不是具体要做什么做什么 控制循环：怎么生成中间步骤呢？通过控制循环 简单 模块化 向下兼容 开放  k8s 架构   k8s 核心通信机制 List-Watch  这里老师讲得真的很清楚，而且认为这个机制是 k8s 最大的特色 k8s 核心功能  资源管理  资源上报  节点资源样例  资源分配   状态维护  资源回收   调度 资源申请   request和limits：底线和上限  调度流程   示例  MySQL  WordPress    优化实践 k8s 还可以更好  字节的一些工作 资源管理  功能增强  性能优化  调度质量  k8s 和 Yarn 的一些不同   k8s：拿着应用找节点 yarn：拿着节点找应用  k8s的调度质量高，但是性能差 课程总结  </div></div></div></a><a class="pagination-related" href="/2022/08/19/%E3%80%8E%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5-4th-%E5%A4%A7%E6%95%B0%E6%8D%AE%E3%80%8FL19%EF%BC%9A%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E7%90%86%E8%AE%BA%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" title="『字节青训营-4th-大数据』L19：用户数据分析理论与最佳实践"><img class="cover" src="/static/202202230023069.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">『字节青训营-4th-大数据』L19：用户数据分析理论与最佳实践</div></div><div class="info-2"><div class="info-item-1">相关链接🎶 学员手册：【大数据专场 学习资料七】第四届字节跳动青训营 - 掘金  P1：基础篇   为什么要做用户数据分析  数据分析的各个环节 数据分析全景图  指标体系和指标分级  手游业务指标体系示意  口径：你怎么算出来的 搭建指标体系的价值  数据分析的各个环节 埋点简介   常见的分析工具      维度：分组项（日期和操作系统），指标：设备去重数 聚和，最大最小… 可以，但一般会先划分   数据可视化   选择合适的    数据分析的流程和案例 分析流程   案例 获取   激活  思考各个环节，哪些是要重点改进的地方 留存  收入  可以得出结论，这个游戏就是靠头部用户来维持运营的，来指导产品经营 数据分析常见的问题  总结&amp;思考   P2：进阶篇  机器学习概览 为什么要机器学习  什么是机器学习  例：垃圾邮件过滤程序 开发者自己从现有的样本提取特性信息，对于新的样本又要手动增加过滤规则 使用机器学习，自动总结、添加规律 机器学习算法有哪些  机器学习的挑战有哪些  特征工程 概述  流程    数据理解  结构化/非结构化 定量/定性   数据预处理  衡量数据质量  准确性 完整性 一致性 时效性 可信性 解释性   主要步骤  数据清洗  缺失值 异常值 噪声   数据集成  实体识别 冗余 数据值冲突   数据规约  维度规约 维度变换   数据交换  规范化 离散化 稀疏化       特征构造  聚合 转换   特征选择  Filter 方法（过滤式） Wrapper方法（封装式） Embedded方法（嵌入式）    （这些在学...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Giscus</span><span id="switch-btn"></span><span class="second-comment">Twikoo</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/static/favicon.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Nick Xu</div><div class="author-info-description">这家伙真勤奋，什么都留下了</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">301</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">57</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/nickxudotme"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="tencent://message/?uin=976180942&amp;Site=tool.520101.com&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="/static/weixin.jpg" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="mailto:nx@nickxu.me" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/rss2.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">因为本人最近工作和学习都很忙，所以博客更新会比较慢，敬请谅解！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%81%E4%B8%9A%E6%95%B0%E6%8D%AE%E6%9E%B6%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">企业数据架构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E6%88%90"><span class="toc-number">1.1.</span> <span class="toc-text">数据集成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%9A%E5%8A%A1%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86"><span class="toc-number">1.1.1.</span> <span class="toc-text">业务数据收集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CDC"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">CDC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">Log</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E9%97%B4%E5%90%8C%E6%AD%A5%E4%BC%A0%E8%BE%93"><span class="toc-number">1.1.2.</span> <span class="toc-text">系统间同步传输</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7-%E7%A6%BB%E7%BA%BF-%E5%AE%9E%E6%97%B6"><span class="toc-number">1.2.</span> <span class="toc-text">数据生产 - 离线&amp;实时</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.</span> <span class="toc-text">数据服务</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%E6%A1%88%E4%BE%8B"><span class="toc-number">2.</span> <span class="toc-text">数据中心案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87"><span class="toc-number">2.1.</span> <span class="toc-text">核心业务指标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%A6%81%E6%B1%82"><span class="toc-number">2.2.</span> <span class="toc-text">数据查询要求</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7"><span class="toc-number">3.</span> <span class="toc-text">实时数据生产</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-number">3.1.</span> <span class="toc-text">数据分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BA%A7%E5%87%BA%E7%9B%AE%E6%A0%87"><span class="toc-number">3.1.1.</span> <span class="toc-text">数据产出目标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7%E5%8F%AF%E8%A1%8C%E6%80%A7"><span class="toc-number">3.1.2.</span> <span class="toc-text">数据生产可行性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%88%86%E6%9E%90"><span class="toc-number">3.2.</span> <span class="toc-text">计算分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87"><span class="toc-number">3.2.1.</span> <span class="toc-text">目标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9E%B6%E6%9E%84-Lambda"><span class="toc-number">3.2.2.</span> <span class="toc-text">计算架构 - Lambda</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BA%A7%E5%87%BA"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">数据产出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">3.2.2.2.</span> <span class="toc-text">问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9E%B6%E6%9E%84-%E5%85%A8%E9%87%8F%E8%AE%A1%E7%AE%97"><span class="toc-number">3.2.3.</span> <span class="toc-text">计算架构 - 全量计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">问题解决</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E9%87%8F%E8%AE%A1%E7%AE%97%E9%97%AE%E9%A2%98"><span class="toc-number">3.2.3.2.</span> <span class="toc-text">全量计算问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%9E%B6%E6%9E%84-%E6%9E%B6%E6%9E%84%E9%80%89%E6%8B%A9"><span class="toc-number">3.2.4.</span> <span class="toc-text">计算架构 - 架构选择</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E9%9A%BE%E7%82%B9"><span class="toc-number">3.3.</span> <span class="toc-text">计算难点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E9%87%8F%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96-Hybrid-Source"><span class="toc-number">3.3.1.</span> <span class="toc-text">全量数据获取 - Hybrid Source</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E7%A1%AE-%E5%A4%84%E7%90%86%E5%8E%BB%E9%87%8D-%E6%9B%B4%E6%96%B0"><span class="toc-number">3.3.2.</span> <span class="toc-text">准确 - 处理去重&amp;更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%86%E7%A1%AE-Join-%E4%B9%B1%E5%BA%8F%E9%97%AE%E9%A2%98%E5%9C%BA%E6%99%AF"><span class="toc-number">3.3.3.</span> <span class="toc-text">准确 - Join 乱序问题场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E7%8E%87-%E8%81%9A%E5%90%88"><span class="toc-number">3.3.4.</span> <span class="toc-text">效率 - 聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%88%E7%8E%87-Join"><span class="toc-number">3.3.5.</span> <span class="toc-text">效率 - Join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%B4%A8%E9%87%8F"><span class="toc-number">3.3.6.</span> <span class="toc-text">数据质量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%BB%E5%8A%A1%E7%A8%B3%E5%AE%9A%E6%80%A7"><span class="toc-number">3.3.6.1.</span> <span class="toc-text">任务稳定性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8C%81%E7%BB%AD%E6%AD%A3%E7%A1%AE%E6%80%A7"><span class="toc-number">3.3.6.2.</span> <span class="toc-text">数据持续正确性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%80%BB%E7%BB%93"><span class="toc-number">3.3.7.</span> <span class="toc-text">计算总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E4%BB%93%E5%BB%BA%E8%AE%BE"><span class="toc-number">3.4.</span> <span class="toc-text">数仓建设</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E6%96%B9%E6%A1%88"><span class="toc-number">3.4.1.</span> <span class="toc-text">数据组织方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86"><span class="toc-number">3.4.2.</span> <span class="toc-text">元数据管理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1-2"><span class="toc-number">4.</span> <span class="toc-text">数据服务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%BF%AB"><span class="toc-number">4.1.</span> <span class="toc-text">查询快</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E6%93%8E%E9%80%89%E6%8B%A9"><span class="toc-number">4.1.1.</span> <span class="toc-text">引擎选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%8E%E4%B9%88%E5%81%9A"><span class="toc-number">4.1.2.</span> <span class="toc-text">怎么做</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%9B%E9%80%89"><span class="toc-number">4.1.3.</span> <span class="toc-text">筛选</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%8C%BA"><span class="toc-number">4.1.3.1.</span> <span class="toc-text">分区</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E6%9E%84%E5%BB%BA"><span class="toc-number">4.1.3.2.</span> <span class="toc-text">主键构建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E6%9F%A5%E6%89%BE"><span class="toc-number">4.1.3.3.</span> <span class="toc-text">主键查找</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E5%A7%8B%E4%BF%A1%E6%81%AF%E5%85%B3%E8%81%94"><span class="toc-number">4.1.4.</span> <span class="toc-text">原始信息关联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%90%91%E9%87%8F%E5%8C%96"><span class="toc-number">4.1.5.</span> <span class="toc-text">计算向量化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-number">4.1.6.</span> <span class="toc-text">执行计划</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%BC%98%E5%8C%96"><span class="toc-number">4.1.7.</span> <span class="toc-text">应用优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%BD%E8%A1%A8%E6%9E%84%E5%BB%BA"><span class="toc-number">4.1.8.</span> <span class="toc-text">宽表构建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E5%8D%87%E4%BF%A1%E6%81%AF%E5%AF%86%E5%BA%A6"><span class="toc-number">4.1.9.</span> <span class="toc-text">提升信息密度</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%B3%E5%AE%9A"><span class="toc-number">4.2.</span> <span class="toc-text">稳定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86"><span class="toc-number">4.3.</span> <span class="toc-text">数据管理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%BE%E7%A8%8B%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">课程总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/hello-2026.html" title="2026 我想写点什么">2026 我想写点什么</a><time datetime="2026-01-17T02:50:14.000Z" title="发表于 2026-01-17 10:50:14">2026-01-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/from-hello-world-to-tencent.html" title="编程十年：那些人，那些事，那些瞬间">编程十年：那些人，那些事，那些瞬间</a><time datetime="2025-10-28T17:59:49.000Z" title="发表于 2025-10-29 01:59:49">2025-10-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/six-months-in-Tencent.html" title="腾讯六月：未曾拥有过的美好时光😘">腾讯六月：未曾拥有过的美好时光😘</a><time datetime="2024-12-07T08:24:50.000Z" title="发表于 2024-12-07 16:24:50">2024-12-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/be-your-authentic-self.html" title="做原汁原味的自己">做原汁原味的自己</a><time datetime="2024-10-15T17:28:43.000Z" title="发表于 2024-10-16 01:28:43">2024-10-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/seven-months-of-struggle-main-part-3.html" title="『七个月的挣扎之路』支线合集">『七个月的挣扎之路』支线合集</a><time datetime="2024-07-15T13:59:55.000Z" title="发表于 2024-07-15 21:59:55">2024-07-15</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2026 By Nick Xu</span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><script src="/js/tw_cn.js?v=5.5.3"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'nickxudotme/nickxudotme.github.io',
      'data-repo-id': 'R_kgDOGzWHdw',
      'data-category-id': 'DIC_kwDOGzWHd84CX4Hy',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.nickxu.top/',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo.nickxu.top/',
      region: 'ap-shanghai',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('/pluginsSrc/twikoo/dist/twikoo.all.min.js?v=1.6.44').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Giscus' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Giscus' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script defer="defer" id="ribbon" src="/pluginsSrc/butterfly-extsrc/dist/canvas-ribbon.min.js?v=1.1.6" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>